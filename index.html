<!DOCTYPE html>
<html>

  <head>
    <meta charset='utf-8'>
    <meta http-equiv="X-UA-Compatible" content="chrome=1">
    <meta name="description" content="Glukose : A Web app to visualize the measures of the glucometer captured by glukose-service">

    <link rel="stylesheet" type="text/css" media="screen" href="stylesheets/stylesheet.css">

    <title>Glukose</title>
  </head>

  <body>

    <!-- HEADER -->
    <div id="header_wrap" class="outer">
        <header class="inner">
          <a id="forkme_banner" href="https://github.com/masalinas/glukose">View on GitHub</a>

          <h1 id="project_title">Glukose</h1>
          <h2 id="project_tagline">A Web app to visualize the measures of the glucometer captured by glukose-service</h2>

            <section id="downloads">
              <a class="zip_download_link" href="https://github.com/masalinas/glukose/zipball/master">Download this project as a .zip file</a>
              <a class="tar_download_link" href="https://github.com/masalinas/glukose/tarball/master">Download this project as a tar.gz file</a>
            </section>
        </header>
    </div>

    <!-- MAIN CONTENT -->
    <div id="main_content_wrap" class="outer">
      <section id="main_content" class="inner">
        <h1>
<a id="glukose" class="anchor" href="#glukose" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Glukose</h1>

<p>A light web solution to parse and manage the measures captured by glukose-service using IBM node-red tool to parse the JSON input measures.</p>

<p><img src="https://cloud.githubusercontent.com/assets/1216181/13285544/78ec2d82-dafb-11e5-859a-20d9731192e3.png" alt="capture_glukose_01"></p>

<p>The Node-red flow measure parser</p>

<p><img src="https://cloud.githubusercontent.com/assets/1216181/13285545/78ecceb8-dafb-11e5-8044-b4c04623b7f4.png" alt="capture_glukose_02"></p>

<h1>
<a id="infraestructure-techonologies" class="anchor" href="#infraestructure-techonologies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Infraestructure Techonologies:</h1>

<ul>
<li>
<a href="https://nodejs.org/">NodeJS</a>: Event-driven I/O server-side JavaScript environment based on V8. Includes API documentation, change-log, examples and announcements.</li>
<li>
<a href="http://expressjs.com">ExpressJS</a>: Express is a minimal and flexible Node.js web application framework that provides a robust set of features for web and mobile applications.</li>
<li>
<a href="https://www.mongodb.org/">MongoDb</a>:MongoDB is the next-generation database that lets you create applications never before possible.</li>
</ul>

<h1>
<a id="backend-techonologies" class="anchor" href="#backend-techonologies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Backend Techonologies:</h1>

<ul>
<li>
<a href="https://strongloop.com/">Loopback</a>: LoopBack is a highly-extensible, open-source Node.js framework. Compare with other frameworks. Quickly create dynamic end-to-end REST APIs</li>
<li>
<a href="http://momentjs.com/">MomentJs</a>: Parse, validate, manipulate, and display dates in JavaScript.</li>
</ul>

<h1>
<a id="frontend-techonologies" class="anchor" href="#frontend-techonologies" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Frontend Techonologies:</h1>

<ul>
<li>
<a href="http://requirejs.org/">RequireJS</a>: RequireJS is a JavaScript file and module loader.</li>
<li>
<a href="https://github.com/requirejs/domReady">Require DomReady</a>: An AMD loader plugin for detecting DOM ready.</li>
<li>
<a href="https://jquery.com">JQuery</a>: jQuery: The Write Less, Do More, JavaScript Library.</li>
<li>
<a href="https://angularjs.org">Angular</a>: AngularJS is what HTML would have been, had it been designed for building web-apps.</li>
<li>
<a href="https://github.com/laurelnaiad/angular-couch-potato">Angular Couch Potato</a>: Lazy-Load and Register Components in AngularJS Applications.</li>
<li>
<a href="https://github.com/angular-ui/ui-router">Angular UI Router</a>: The de-facto solution to flexible routing with nested views in AngularJS.</li>
<li>
<a href="https://angularjs.org">Angular Animate</a>: AngularJS provides animation hooks for common directives.</li>
<li>
<a href="https://angular-ui.github.io/bootstrap/">Angular Bootstrap</a>: Bootstrap components written in pure AngularJS by the AngularUI Team.</li>
<li>
<a href="http://getbootstrap.com/">Bootstrap</a>: Bootstrap, a sleek, intuitive, and powerful mobile first front-end framework for faster and easier web development.</li>
<li>
<a href="http://pixelkit.com/">DarkVelvet</a>: Free UI Kits built on Bootstrap for any developer that wants to build a cool looking and functional website.</li>
<li>
<a href="http://momentjs.com/">MomentJs</a>: Parse, validate, manipulate, and display dates in JavaScript.</li>
<li>
<a href="https://datatables.net/">Datatable</a>: DataTables is a plug-in for the jQuery Javascript library.</li>
</ul>

<h1>
<a id="installation" class="anchor" href="#installation" aria-hidden="true"><span aria-hidden="true" class="octicon octicon-link"></span></a>Installation:</h1>

<p>Copy and import this flow from node-red import clipboard:</p>

<pre><code>[{"id":"cab4e39d.354b2","type":"watch","z":"640e548a.9bf1ac","name":"in-box","files":"/home/miguel/test/glukometer/export/","x":72,"y":62,"wires":[["7811681b.87ee98"]]},{"id":"209f559c.df60aa","type":"function","z":"640e548a.9bf1ac","name":"historic 01","func":"console.log('Start historic 01 node');\n\nvar fs = context.global.fs;\n\nif (fs === undefined)\n    node.error(\"fs module is not accessible\", msg);\n\n// move sensor file to historic folder\nfs.rename('/home/miguel/test/glukometer/export/' + msg.file, '/home/miguel/test/glukometer/export/.historic/' + msg.file, function (err) {\n    if (err) node.error(\"Historic error\", msg);\n    \n    node.log('Historic complete');\n    \n    node.send(msg);\n});\n\nreturn;","outputs":1,"noerr":0,"x":640,"y":62,"wires":[["75ab55bd.8a54ac"]]},{"id":"75ab55bd.8a54ac","type":"debug","z":"640e548a.9bf1ac","name":"out debug","active":true,"console":"false","complete":"payload","x":856,"y":62,"wires":[]},{"id":"be3aad0.f41c55","type":"catch","z":"640e548a.9bf1ac","name":"","scope":null,"x":192,"y":224,"wires":[["96d23fad.692dc"]]},{"id":"96d23fad.692dc","type":"function","z":"640e548a.9bf1ac","name":"historic 02","func":"console.log('Start historic 02 node');\n\nvar fs = context.global.fs;\n\nif (fs === undefined)\n    node.error(\"fs module is not accessible\", msg);\n\nif (msg.file === undefined)\n    return msg;\n    \n// move sensor file to historic folder\nfs.rename('/home/miguel/test/glukometer/export/' + msg.file, '/home/miguel/test/glukometer/export/.historic/' + msg.file, function (err) {\n    if (err) node.error(\"Historic error\", msg);\n\n    node.log('Historic complete');\n    \n    node.send(msg);\n});\n\nreturn;","outputs":1,"noerr":0,"x":393,"y":224,"wires":[["66e2ce50.991d3"]]},{"id":"66e2ce50.991d3","type":"debug","z":"640e548a.9bf1ac","name":"error","active":true,"console":"false","complete":"payload","x":612,"y":224,"wires":[]},{"id":"7811681b.87ee98","type":"function","z":"640e548a.9bf1ac","name":"parse","func":"console.log('Start parse node');\n\nvar fs = context.global.fs;\nvar moment = context.global.moment;\n\nif (fs === undefined)\n    node.error(\"fs module is not accessible\", msg);\n\n// preveent when remove files. The watch fire with a none file\nif (msg.type == 'none')   \n    return;\n        \n// recover sensor file from folder\nfs.readFile('/home/miguel/test/glukometer/export/' + msg.file, function(err, data) {\n    if (err) \n        node.error(\"Reading file error\", msg);\n\n    // convert from string to JSON\n    msg.payload = JSON.parse(data);\n\n    node.send(msg);\n});\n\nreturn;","outputs":1,"noerr":0,"x":254,"y":62,"wires":[["3a803a3d.c57fc6"]]},{"id":"3a803a3d.c57fc6","type":"function","z":"640e548a.9bf1ac","name":"persist","func":"console.log('Start persist node');\n\nvar loopback = context.global.loopback;\nvar Device = loopback.models.Device;\n\n// recover measure\nvar mes = msg.payload;\n\n// create or update the device measure\nDevice.findOne({\"serlnum\" : mes.serlnum, \n                \"ptname\" : mes.ptname,\n                \"ptid\" : mes.ptid},  function(err, device) {\n        if (err) node.error(\"findOne device error\", msg);\n\n        if (device === null) {\n            device = {\"serlnum\" : mes.serlnum,\n                      \"ptname\" : mes.ptname,\n                      \"ptid\" : mes.ptid,\n                      \"date\": mes.date};\n        }\n        else\n            device.date = mes.date;\n            \n        Device.upsert(device, function(err, device) {\n            if (err) node.error(\"upsert device error\", msg);\n        \n            // insert all measures from device\n            device.measures.create(mes.measures, function (err, device) {\n                if (err) node.error(\"create measures error\", msg);\n\n                // persist all the new measures\n                /*mes.measures.forEach(function(measure) {\n                    console.log('Measure: ' + measure.value);\n                    \n                });*/\n                \n                msg.payload = device;\n                \n                node.send(msg);\n            });\n        });           \n    });\n    \n\nreturn;","outputs":1,"noerr":0,"x":432,"y":62,"wires":[["209f559c.df60aa"]]}]
</code></pre>

<p>Execute npm to install node packages:</p>

<pre><code>  npm install
</code></pre>

<p>Execute bower to install ui packages:</p>

<pre><code>  bower install
</code></pre>

<p>Start Web</p>

<pre><code>  http://localhost:2000
</code></pre>

<p>Start Node-Red</p>

<pre><code>  http://localhost:2000/red
</code></pre>
      </section>
    </div>

    <!-- FOOTER  -->
    <div id="footer_wrap" class="outer">
      <footer class="inner">
        <p class="copyright">Glukose maintained by <a href="https://github.com/masalinas">masalinas</a></p>
        <p>Published with <a href="https://pages.github.com">GitHub Pages</a></p>
      </footer>
    </div>

    

  </body>
</html>
